<div class="main-div">
  <button mat-icon-button 
    [matMenuTriggerFor]="taskMenu"
    class="delete">
    <mat-icon>more_vert</mat-icon>
  </button>
  <mat-menu #taskMenu="matMenu">
    <button mat-menu-item (click)="editTask()">Edit</button>
    <button mat-menu-item (click)="deleteTask()">Delete</button>
  </mat-menu>
  <mat-card-title>{{currentTask.name}}</mat-card-title>
  <mat-card-subtitle>Category: {{currentTask.category}}, Urgency: {{currentTask.urgency}}</mat-card-subtitle>
  <mat-card-content>{{currentTask.description}}</mat-card-content>
  <mat-divider></mat-divider>

  <div class="timer-div-div">
    <div class="timer-div"
      [ngClass]="{'timer-bg-pause' : timer.isTimerPaused, 'timer-bg-pomodoro' : !timer.isTimerPaused}"
      *ngIf="timer.currentTaskId == taskId || timer.currentTaskId == 'unset'">
      <div class="timer-header">
        <mat-icon>alarm</mat-icon>
        <span>{{timer.activeTimer ? timer.activeTimer.clock[0] : ''}} : {{timer.activeTimer ? timer.activeTimer.clock[1] : ''}}</span>
      </div>
      <div>
        <button mat-icon-button>
          <mat-icon *ngIf="showPlay"
          (click)="startTimer(); showPlay = !showPlay">
            play_arrow
          </mat-icon>
          <mat-icon *ngIf="!showPlay" 
          (click)="timer.pauseTimer(); showPlay = !showPlay">
            pause_arrow
          </mat-icon>
        </button>
        <button mat-icon-button (click)="timer.addFiveMinutesToTimer()">
          <span> +5min</span>
        </button>
        <button mat-icon-button (click)="timer.restartTimer()">
          <mat-icon>refresh</mat-icon>
        </button>
        <button mat-icon-button (click)="timer.finishTimer()">
          <mat-icon>arrow_forward</mat-icon>
        </button>
      </div>
      <div>
        <table>
          <tr>
            <td>Arbeitsphase</td>
            <td>{{currentTask.numPomodoroDone}}/{{currentTask.numPomodoro}}</td>
          </tr>
          <tr *ngIf="timer.isTimerPaused">
            <td style="color: red;">Pause</td>
            <td></td>
          </tr>
        </table>
      </div>
    </div>

    <div class="status-div">
      <div *ngIf="currentTask.dueDate">
        <span>Due Date: {{currentTask.dueDate | date : 'fullDate'}}</span>
      </div>
      <div>
        <span>Number Pomodoros left: {{currentTask.numPomodoro - currentTask.numPomodoroDone}}</span>
      </div>
      <div>
        <button mat-icon-button (click)="addPomodoro()">
          <mat-icon>add</mat-icon>
        </button>
        <button mat-icon-button (click)="removePomodoro()">
          <mat-icon>remove</mat-icon>
        </button>
      </div>
    </div>
  </div>



</div>